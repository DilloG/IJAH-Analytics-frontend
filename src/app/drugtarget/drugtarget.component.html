<div id="d-title">
  <div class="container">
    <h1>Drug-Target Connectivity</h1>
  </div>
</div>

<div id="d-input">
  <div class="container">
    <div class="dic-button-atas">
    <h2 class="dic-title"> Choose Input Side : </h2>
    <button type="reset" [style.background]="dsInput ? '#4CAF50' : '#3E4B3E'" (click)="ds_input_btn()">Drug Side</button>
    <button type="reset" [style.background]="tsInput ? '#4CAF50' : '#3E4B3E'" (click)="ts_input_btn()">Target Side</button>
    <button type="reset" [style.background]="dstsInput ? '#4CAF50' : '#3E4B3E'" (click)="dsts_input_btn()">Drug & Target Side</button>
    </div>
  </div>
  <form #dtInputForm="ngForm"  (ngSubmit)="predict()">
  <div class="container">
    <div class="di-container" *ngIf="dsInput || dstsInput">
      <h1 class="dic-title">Drug Side</h1>
      <div class="dic-button">
        <button type="button" [style.background]="pla_input_btn ? '#4CAF50' : '#3E4B3E'" (click)="plant_input()">Plant Input</button>
        <button type="button" [style.background]="com_input_btn ? '#4CAF50' : '#3E4B3E'" (click)="compound_input()">Compound Input</button>
      </div>

      <div *ngIf="pla_input_btn">
        <h1 class="choice-title">Plant Input</h1>
        <div class="dic_input">
          <div class="ngForm" *ngFor="let plantFor of plantFor; let i = index;">
            <div>
              <input id="typeahead-target" type="text" class="form-control"
              [ngModelOptions]="{standalone: true}"
              [ngbTypeahead]="searchPlant"
              [(ngModel)]="plantFor.name"
              [value]="plantFor.name" />
              <button class="close-icon" type="reset" (click)="removePlant(i)"><img src="assets/img/reset.png"/></button>
            </div>
          </div>
          <div class="close_icon">
            <button type="button" [style.display]="addDrug_btn > 4 ? 'none' : 'inline'" (click)="addPlant(i)">+ Add Input</button>
          </div>
        </div>

      </div>

      <div *ngIf="com_input_btn">
          <h1 class="choice-title">Compound Input</h1>
          <div class="dic_input">
            <div class="ngForm" *ngFor="let compoundFor of compoundFor; let i = index;">
              <div>
                <input id="typeahead-target" type="text" class="form-control"
                [ngModelOptions]="{standalone: true}"
                [ngbTypeahead]="searchCompound"
                [(ngModel)]="compoundFor.name"
                [value]="compoundFor.name" />
                <button class="close-icon" type="button" (click)="removeCompound(i)"><img src="assets/img/reset.png"/></button>
              </div>
            </div>
            <div class="close_icon">
              <button type="button" [style.display]="addDrug_btn > 4 ? 'none' : 'inline'" (click)="addCompound()">+ Add Input</button>
            </div>
          </div>
      </div>
    </div>
    <div class="di-container" *ngIf="tsInput || dstsInput">
      <h1 class="dic-title">Target Side</h1>
      <div class="dic-button">
        <button type="button" [style.background]="pro_input_btn ? '#4CAF50' : '#3E4B3E'" (click)="protein_input()">Protein Input</button>
        <button type="button" [style.background]="dis_input_btn ? '#4CAF50' : '#3E4B3E'" (click)="disease_input()">Disease Input</button>
      </div>

      <div *ngIf="pro_input_btn">
        <h1 class="choice-title">Protein Input</h1>
        <div class="dic_input">
          <div class="ngForm" *ngFor="let proteinFor of proteinFor; let i = index;">
            <div>
              <input id="typeahead-target" type="text" class="form-control"
              [ngModelOptions]="{standalone: true}"
              [ngbTypeahead]="searchProtein"
              [(ngModel)]="proteinFor.name"
              [value]="proteinFor.name" />
              <button class="close-icon" type="reset" (click)="removeProtein(i)"><img src="assets/img/reset.png"/></button>
            </div>
          </div>
          <div class="close_icon">
            <button type="button" [style.display]="addTarget_btn > 4 ? 'none' : 'inline'" (click)="addProtein(i)">+ Add Input</button>
          </div>
        </div>

      </div>

      <div *ngIf="dis_input_btn">
          <h1 class="choice-title">Disease Input</h1>
          <div class="dic_input">
            <div class="ngForm" *ngFor="let diseaseFor of diseaseFor; let i = index;">
              <div>
                <input id="typeahead-target" type="text" class="form-control"
                [ngModelOptions]="{standalone: true}"
                [ngbTypeahead]="searchDisease"
                [(ngModel)]="diseaseFor.name"
                [value]="diseaseFor.name" />
                <button class="close-icon" type="button" (click)="removeDisease(i)"><img src="assets/img/reset.png"/></button>
              </div>
            </div>
            <div class="close_icon">
              <button type="button" [style.display]="addTarget_btn > 4 ? 'none' : 'inline'" (click)="addDisease()">+ Add Input</button>
            </div>
          </div>
      </div>
    </div>
  </div>
  <div class="di-button">
    <!-- <button class="reset" (click)="resetinput()">Reset</button> -->
    <button type="submit" value="Submit">Search</button>
  </div>
  </form>
</div>


<div id="loading" *ngIf='showload'>
  <div class="loader"></div>
  <h5>predicting..</h5>
</div>

<div id="loading" *ngIf='showloadFirst'>
  <div class="loader"></div>
  <h5>loading..</h5>
</div>


<div id="d-result" *ngIf='showresult'>
  <div class="container">
    <h1>Drug-Target Result</h1>
    <ngb-tabset [destroyOnHide]="false">
      <ngb-tab title="Summary">
        <ng-template ngbTabContent>
          <div class="drs-place">
            <div class="drsp-atas">
              <div class="drspa-atas">
                <h6 class="score">{{totalScore}}</h6>
                <h6 class="scoreName">Total Connectivity Score</h6>
              </div>
              <div class="drspa-bawah">
                <div>
                  <h6 class="score" [style.color]="'#2ECC43'">{{pla_com_score}}</h6>
                  <h6 class="scoreName">Plant-Compound Connectivity Score</h6>
                </div>
                <div>
                  <h6 class="score" [style.color]="'#94AE27'">{{com_pro_score}}</h6>
                  <h6 class="scoreName">Compound-Protein Connectivity Score</h6>
                </div>
                <div>
                  <h6 class="score" [style.color]="'#AE2762'">{{pro_dis_score}}</h6>
                  <h6 class="scoreName">Protein-Disease Connectivity Score</h6>
                </div>
              </div>
            </div>

            <div class="drsp-bawah">
              <div class="drspb-kiri">
                <div>
                  <h6 class="score">{{plaMeta_table.length}}</h6>
                  <h6>Plants</h6>
                </div>
                <div>
                  <h6 class="score">{{comMeta_table.length}}</h6>
                  <h6>Compounds</h6>
                </div>
                <div>
                  <h6 class="score">{{proMeta_table.length}}</h6>
                  <h6>Proteins</h6>
                </div>
                <div>
                  <h6 class="score">{{disMeta_table.length}}</h6>
                  <h6>Diseases</h6>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </ngb-tab>
      <ngb-tab title="Connectivity Graph">
        <ng-template ngbTabContent>
          <div class="btn btn-primary" (click)="downloadImage()">DL</div>
          <div id="download">
            <img #canvas>
            <a #downloadLink></a>
          </div>
          <div class="legendgraph">
            <p>Plant</p>
            <p>Compound</p>
            <p>Compound</p>
            <p>Protein</p>
            <p>Disease</p>
          </div>
          <div #screen class="chartnya">
            <google-chart *ngIf="showChart" #chart [title]="title" [type]="type" [data]="sankeyData" [columnNames]="columnNames" [options]="options" [width]="width" [height]="height">
            </google-chart>
          </div>
        </ng-template>
      </ngb-tab>
      <ngb-tab title="Connectivity Table">
        <ng-template ngbTabContent>
          <div class="ct_button">
              <button [style.background]="pla_com_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="pla_com_btn ? '#ffffff' : '#000000'"
                      (click)="pla_com_on()">Plant - Compound</button>
              <button [style.background]="com_pro_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="com_pro_btn ? '#ffffff' : '#000000'"
                      (click)="com_pro_on()">Compound - Protein</button>
              <button [style.background]="pro_dis_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="pro_dis_btn ? '#ffffff' : '#000000'"
                      (click)="pro_dis_on()">Protein - Disease</button>
          </div>
          <div class="ct_table" *ngIf="pla_com_btn">
            <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" *ngIf="con_plaCom" class="row-border hover">
              <thead>
                <tr>
                  <th>Plant Id</th>
                  <th>Plant Latin</th>
                  <!-- <th>Plant Indonesia</th> -->
                  <th>Connectivity Weight</th>
                  <th>Compound Id</th>
                  <th>Compound Name</th>
                  <!-- <th>Compound IUPAC</th> -->
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let placom_con_table of placom_con_table">
                  <td>{{placom_con_table.pla_id}}</td>
                  <td><a href="javascript:void(0)" (click)="generateLink(placom_con_table.pla_nlat)">{{placom_con_table.pla_nlat}}</a></td>
                  <!-- <td>{{placom_con_table.pla_nidr}}</td> -->
                  <td [style.width]="'40px'" [style.background]="'#8cff92'">{{placom_con_table.weight}}</td>
                  <td>{{placom_con_table.com_id}}</td>
                  <td><a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{placom_con_table.com_name}}" target="_blank">{{placom_con_table.com_name}}</a></td>
                  <!-- <td>{{placom_con_table.com_npac}}</td> -->
                </tr>
              </tbody>
            </table>
          </div>
          <div class="ct_table" *ngIf="com_pro_btn">
            <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" *ngIf="con_comPro" class="row-border hover">
              <thead>
                <tr>
                  <th>Compound Id</th>
                  <th>Compound Name</th>
                  <!-- <th>Compound IUPAC</th> -->
                  <th>Connectivity Weight</th>
                  <th>Protein Id</th>
                  <th>Protein Name</th>
                  <!-- <th>Protein Uniprot ABBRV</th> -->
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let compro_con_table of compro_con_table">
                  <td>{{compro_con_table.com_id}}</td>
                  <td>{{compro_con_table.com_name}}</td>
                  <!-- <td>{{compro_con_table.com_npac}}</td> -->
                  <td [style.width]="'40px'" [style.background]="'#8cff92'">{{compro_con_table.weight}}</td>
                  <td>{{compro_con_table.pro_id}}</td>
                  <td>{{compro_con_table.pro_name}}</td>
                  <!-- <td>{{compro_con_table.pro_uab}}</td> -->
                </tr>
              </tbody>
            </table>
          </div>
          <div class="ct_table" *ngIf="pro_dis_btn">
            <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" *ngIf="con_proDis" class="row-border hover">
              <thead>
                <tr>
                  <th>Protein Name</th>
                  <th>Connectivity Weight</th>
                  <th>Disease Name</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let con_proDis of con_proDis">
                  <td>{{con_proDis.pro_id}}</td>
                  <td>{{con_proDis.weight}}</td>
                  <td>{{con_proDis.dis_id}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </ng-template>
      </ngb-tab>
      <ngb-tab title="Metadata">
        <ng-template ngbTabContent>
          <div class="ct_button">
              <button [style.background]="pla_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="pla_btn ? '#ffffff' : '#000000'"
                      (click)="pla_on()">Plant</button>
              <button [style.background]="com_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="com_btn ? '#ffffff' : '#000000'"
                      (click)="com_on()">Compound</button>
              <button [style.background]="pro_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="pro_btn ? '#ffffff' : '#000000'"
                      (click)="pro_on()">Protein</button>
              <button [style.background]="dis_btn ? '#2ECC71' : '#C9C6C6'"
                      [style.color]="dis_btn ? '#ffffff' : '#000000'"
                      (click)="dis_on()">Disease</button>
          </div>
          <div class="meta_table" *ngIf="pla_btn">
            <table datatable [dtOptions]="dtOptions" *ngIf="pla_meta_table" [dtTrigger]="dtTrigger" class="row-border hover">
              <thead>
                <tr>
                  <th>Plant ID</th>
                  <th>Latin Name</th>
                  <th>Indonesia Name</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let pla_meta_table of pla_meta_table">
                  <td>{{pla_meta_table.pla_id}}</td>
                  <td><a href="javascript:void(0)" (click)="generateLink(pla_meta_table.pla_nlat)">{{pla_meta_table.pla_nlat}}</a></td>
                  <td>{{pla_meta_table.pla_nidr}}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="meta_table" *ngIf="com_btn">
            <table datatable [dtOptions]="dtOptions" *ngIf="com_meta_table" [dtTrigger]="dtTrigger" class="row-border hover">
              <thead>
                <tr>
                  <th>Compound ID</th>
                  <th>Pubchem Name</th>
                  <th>IUPAC Name</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let com_meta_table of com_meta_table">
                  <td>{{com_meta_table.com_id}}</td>
                  <td><a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{com_meta_table.com_name}}" target="_blank">{{com_meta_table.com_name}}</a></td>
                  <td>{{com_meta_table.com_npac}}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="meta_table" *ngIf="pro_btn">
            <table datatable [dtOptions]="dtOptions" *ngIf="pro_meta_table" [dtTrigger]="dtTrigger" class="row-border hover">
              <thead>
                <tr>
                  <th>Protein ID</th>
                  <th>Uniprot Name</th>
                  <th>ABBRV Name</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let pro_meta_table of pro_meta_table">
                  <td>{{pro_meta_table.pro_id}}</td>
                  <td><a href="https://www.uniprot.org/uniprot/{{pro_meta_table.pro_uab}}" target="_blank">{{pro_meta_table.pro_name}}</a></td>
                  <td><a href="https://www.uniprot.org/uniprot/{{pro_meta_table.pro_uab}}" target="_blank">{{pro_meta_table.pro_uab}}</a></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="meta_table" *ngIf="dis_btn">
            <table datatable [dtOptions]="dtOptions" *ngIf="dis_meta_table" [dtTrigger]="dtTrigger" class="row-border hover">
              <thead>
                <tr>
                  <th>Disease ID</th>
                  <th>Disease Name</th>
                  <th>OMIM Number</th>
                  <th>ABBRV Name</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let dis_meta_table of dis_meta_table">
                  <td>{{dis_meta_table.dis_id}}</td>
                  <td><a href="https://www.omim.org/entry/{{dis_meta_table.dis_oid}}" target="_blank">{{dis_meta_table.dis_name}}</a></td>
                  <td><a href="https://www.omim.org/entry/{{dis_meta_table.dis_oid}}" target="_blank">{{dis_meta_table.dis_oid}}</a></td>
                  <td><a href="https://www.uniprot.org/diseases/?query={{dis_meta_table.dis_uab}}&sort=score" target="_blank">{{dis_meta_table.dis_uab}}</a></td>
                </tr>
              </tbody>
            </table>
          </div>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>

  </div>
</div>
